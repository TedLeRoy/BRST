<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8">

    <title>Services and Protocols | BRST</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="css/bootstrap.css" media="screen" rel="stylesheet">
    <link href="css/bootswatch.min.css" rel="stylesheet">
    <!--[if lt IE 9]><script src="../bower_components/html5shiv/dist/html5shiv.js"></script> <script src="../bower_components/respond/dest/respond.min.js"></script> <![endif]-->
    <link href="img/brst-brand.png" rel="icon" type="image/png">
	<style>a.anchor{display: block; position: relative; top: -100px; visibility: hidden;}</style>
</head>

<body>
    <div class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="index.html"><img alt="Brand" src=
                "img/brst-brand.png" style=
                "max-width:100px; margin-top: -7px;"></a> <button class=
                "navbar-toggle" data-target="#navbar-main" data-toggle=
                "collapse" type="button"><span class="icon-bar"></span>
                <span class="icon-bar"></span> <span class=
                "icon-bar"></span></button>
            </div>

            <div class="navbar-collapse collapse" id="navbar-main">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="normal.html">Normal</a>
                    </li>

                    <li>
                        <a href="advanced.html">Advanced</a>
                    </li>

                    <li>
                        <a href="faq.html">FAQ</a>
                    </li>

                    <li>
                        <a href="download.html">Download</a>
                    </li>

                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown">Help
                        <span class="caret"></span></a>

                        <ul class="dropdown-menu">
                            <li>
                                <a href="crypto-key-generation.html">Crypto Key
                                Generation</a>
                            </li>

                            <li>
                                <a href=
                                "troubleshooting.html">Troubleshooting</a>
                            </li>

                            <li>
                                <a href="services-and-protocols.html">Services
                                and Protocols</a>
                            </li>
                        </ul>
                    </li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="about.html">About</a>
                    </li>

                    <li>
                        <a href="contact.html">Contact</a>
                    </li>

                    <li>
                        <a href="copying.html">Copying</a>
                    </li>
                </ul>
            </div>
        </div>
    </div><br>

    <div class="container">
        <div class="row">
		
          <div class="col-lg-12">
		  <h2>Services and Protocols</h2>
		  </div>
            <div class="col-lg-4 col-md-4">
                <div id="MainMenu">
                    <div class="list-group panel">
					<a class=
                        "list-group-item list-group-item-default" data-parent=
                        "#MainMenu" data-toggle="collapse" href="#grctbd">Global Router Commands<br/>to be disabled</a>

                        <div class="collapse" id="grctbd">
                            <a class="list-group-item" href="#boot">Network Boot</a>
                            <a class="list-group-item" href="#cdp">Cisco Discovery Protocol</a>
                            <a class="list-group-item" href="#svc">Configuration Auto-loading</a>
                            <a class="list-group-item" href="#dhcp">Dynamic Host Configuration Protocol</a>
                            <a class="list-group-item" href="#pad">X.25 Packet Assembler/Disassembler Service</a>
                            <a class="list-group-item" href="#finger">Finger</a>
                            <a class="list-group-item" href="#grat_arps">Gratuitous Arps</a>
                            <a class="list-group-item" href="#http">HTTP Server</a>
                            <a class="list-group-item" href="#http_sec">HTTP Secure Server</a>
                            <a class="list-group-item" href="#name_srv">Name Server</a>
                            <a class="list-group-item" href="#src_rt">Source Routing</a>
                            <a class="list-group-item" href="#lldp">Link Layer Discovery Protocol</a>
                            <a class="list-group-item" href="#tcp_ss">TCP Small-Servers</a>
                            <a class="list-group-item" href="#udp_ss">UDP Small-Servers</a>
                        </div>
					<a class=
                        "list-group-item list-group-item-default" data-parent=
                        "#MainMenu" data-toggle="collapse" href="#isctbd">Interface Specific Commands<br/>to be disabled</a>

                        <div class="collapse" id="isctbd">
                            <a class="list-group-item" href="#cdp_ena">Cisco Discovery Protocol</a>
                            <a class="list-group-item" href="#ip_bcast">Directed-broadcast</a>
                            <a class="list-group-item" href="#redirects">Redirects</a>
                            <a class="list-group-item" href="#proxy_arp">Proxy-arp</a>
                            <a class="list-group-item" href="#mask_reply">Mask-reply</a>
                            <a class="list-group-item" href="#unreachables">Unreachables</a>
                            <a class="list-group-item" href="#mop">Maintenance Operations Protocol</a>
                            <a class="list-group-item" href="#ntp">Network Time Protocol</a>
                            <a class="list-group-item" href="#loopback">Lopback Interface</a>
                            <a class="list-group-item" href="#null">Null Interface</a>
                            <a class="list-group-item" href="#aux">Auxilliary Port</a>
                            <a class="list-group-item" href="#console">Console Port</a>
                            <a class="list-group-item" href="#vty">Virtual Terminal (vty) Ports</a>
                        </div>
					<a class=
                        "list-group-item list-group-item-default" data-parent=
                        "#MainMenu" data-toggle="collapse" href="#grctbe">Global Router Commands<br/>to be enabled</a>

                        <div class="collapse" id="grctbe">
                            <a class="list-group-item" href="#cef">ip cef</a>
                            <a class="list-group-item" href="#ntp_receive">ntp receive</a>
                            <a class="list-group-item" href="#pw_encryption">password-encryption</a>
                            <a class="list-group-item" href="#tcp_keepalives_in">tcp-keepalives-in</a>
                            <a class="list-group-item" href="#tcp_keepalives_out">tcp-keepalives-out</a>
                            <a class="list-group-item" href="#ssh_time_out">ssh timeout</a>
                            <a class="list-group-item" href="#ssh_auth_retries">ssh authentication retries</a>
                            <a class="list-group-item" href="#aux2">aux port Configuration</a>
                            <a class="list-group-item" href="#console2">Console Port</a>
                            <a class="list-group-item" href="#vty2">vty ports</a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-8 col-md-8">
                <h3>Global Router Commands<br/>to be disabled</h3>

					<div class="panel panel-default">
					  <div class="panel-body">
					  <a id="boot" class="anchor"></a><b>Network Boot (service boot network)</b><br />
						Routers with network boot enabled will search for boot files on the network during boot.
					This is rarely used, but could permit methods of attack.  <br />
					<span class="label label-warning">Disabling is recommended</span>
					  </div>
					</div>

					<div class="panel panel-default"><div class="panel-body"><a id="cdp" class="anchor"></a><b>Cisco Discovery Protocol (service cdp)</b><br />Cisco Discovery Protocol sends and receives information about the reporting device
					and receives information about other Cisco devices.
					Cdp should not be used on border routers and should not be needed internally.<br />
					<span class="label label-warning">Disabling is recommended</span> </div>
					</div>

					<div class="panel panel-default"><div class="panel-body"><a id="svc" class="anchor"></a><b>Configuration Auto-loading (service config)</b><br />A router with Configuration Auto-loading enabled will attempt to load its configuration
					file from a TFTP server.  An attacker may be able to have a malicious configuration loaded.<br />
					<span class="label label-warning">Disabling is recommended</span> </div>
					</div>

					<div class="panel panel-default"><div class="panel-body"><a id="dhcp" class="anchor"></a><b>Dynamic Host Configuration Protocol (service dhcp)</b><br />Dhcp provides Internet Protocol (IP) addresses to hosts that request them.
					On corporate networks this is usually handled by a dedicated server, not by a router.<br />
					<span class="label label-warning">Disabling is recommended</span> </div>
					</div>

					<div class="panel panel-default"><div class="panel-body"><a id="pad" class="anchor"></a><b>X.25 Packet Assembler/Disassembler Service (service pad)</b><br />Pad Service is used for some older Wide Area Networking (WAN) connections.
					If not configured for your WAN, it should be explicitly turned off.<br />
					<span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="finger" class="anchor"></a><b>Finger (ip finger)</b><br />The IP Finger service can tell requesters who is logged into a router.
					This information can be accessed in other ways by authorized users.<br />
					<span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="grat_arps" class="anchor"></a><b>Gratuitous Arps (ip gratuitous-arps)</b><br />A router can send Address Resolution Protocol (ARP) requests on behalf of another device.
					These requests are called gratuitous arps.  This functionality should not be needed on a
					correctly configured network, and could be a vector for attack.<br />
					<span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="http" class="anchor"></a><b>HTTP Server (ip http server)</b><br />The Hypertext Transfer Protocol (HTTP) Server service makes the router into a web server
					allowing web administration of the router.  Routers configured by command line do not need this.<br />
					<span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="http_sec" class="anchor"></a><b>HTTP Secure Server (ip http secure-server)</b><br />The Hypertext Transfer Protocol (HTTP) Secure Server service makes the router into an encryption
					capable web server allowing more secure web administration of the router than http server.  Routers
					configured by command line do not need this.<br />
					<span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="name_srv" class="anchor"></a><b>Name Server (ip name-server)</b><br />Enabling ip name-server on a router lets the router resolve Domain Name System (DNS) names.
					Routers should rarely have to resolve names on a corporate network.  Most have dedicated DNS servers
					for name resolution.  An enabled ip name-server service on a router can be an avenue for attack. <br />
					<span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="src_rt" class="anchor"></a><b>Source Routing (ip source-route)</b><br />Source Routing enables a sender to specify the path that should be used for return packets.  It is
					rarely used in production environments but can be very useful to attackers.  They can receive
					normally unroutable or "spoofed" packets back providing valuable information. <br />
					<span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="lldp" class="anchor"></a><b>Link Layer Discovery Protocol (lldp run)</b><br />Link Layer Discovery Protocol (lldp) is similar to Cisco Discovery Protocol (cdp) but is an open
					standard.  Institute of Electrical and Electronics Engineers (IEEE) standard 802.1AB details the
					specification.  Lldp should not be needed and should definitely be disabled on edge routers.
					Lldp has not been incorporated into Cisco IOS as of the date of this writing.  If not available
					on your router, running the command results in a harmless error.<br />
					<span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="tcp_ss" class="anchor"></a><b>TCP Small-Servers (service tcp-small-servers)</b><br />TCP and UDP Small-Servers enables a suite of services such as echo, chargen, daytime, and more.
					These services should not be needed for normal operation but could provide an attacker with
					information about your router or your network. <br />
					<span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="udp_ss" class="anchor"></a><b>UDP Small-Servers (service udp-small-servers)</b><br />TCP and UDP Small-Servers enables a suite of services such as echo, chargen, daytime, and more.
					These services should not be needed for normal operation but could provide an attacker with
					information about your router or your network. <br />
					<span class="label label-warning">Disabling is recommended</span> </div></div>
					
					<h3>Interface Specific Commands<br/>to be disabled</h3>

					<div class="panel panel-default"><div class="panel-body"><a id="cdp_ena" class="anchor"></a><b>Cisco Discovery Protocol (service cdp)</b><br />Cisco Discovery Protocol sends and receives information about the reporting device
					and receives information about other Cisco devices.<br />
					Cdp should not be used on border routers and should not be needed internally.
					Although this command is not needed if cdp has been disabled globally, adding it
					to the interfaces does no harm.<br />
					<span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="ip_bcast" class="anchor"></a><b>Directed-broadcast (directed-broadcast)</b><br />IP Directed Broadcast lets a host on one Local Area Network (LAN) segment
					This feature should not be needed and can be used for attacks if enabled.<br /><span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="redirects" class="anchor"></a><b>Redirects (ip redirects)</b><br />IP Redirect causes the router to send redirect messages when prompted.
					An attacker can use this feature to gain information about your network
					and for some forms of attack.<br /><span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="proxy_arp" class="anchor"></a><b>Proxy-arp (ip proxy-arp)</b><br />IP Proxy-arp permits the router to send Address Resolution Protocol (arp)
					requests on behalf of a host on another network.  Proxy-arp can give an
					attacker information and could be used in some attacks.<br /><span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="mask_reply" class="anchor"></a><b>Mask-reply (ip mask-reply)</b><br />IP Mask-reply causes the router to provide the network mask of networks
					it is aware of.  An attacker can use this in mapping the networks and
					determining potential host addresses to conduct further reconnaissance on.<br /><span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="unreachables" class="anchor"></a><b>Unreachables (ip unreachables)</b><br />IP Unreachables are generated on the router for networks that it cannot
					route to.  Through process of elimination, this information can be used to
					map a network.  Networks that do not return unreachables are known and may
					be configured on the router.  They at least exist in its routing tables.<br /><span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="mop" class="anchor"></a><b>Maintenance Operations Protocol (mop)</b><br />Maintenance Operations Protocol is a DECNet protocol that is not needed
					on most networks.  Any unneded protocols should be disabled to reduce possible
					attack vectors.<br /><span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="ntp" class="anchor"></a><b>Network Time Protocol (ntp)</b><br />Network Time Protocol (ntp) should be configured on the router, but should
					only be enabled on and configured on the loopback interface.  It should be
					disabled on all other interfaces.<br /><span class="label label-warning">Disabling is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="loopback" class="anchor"></a><b>Lopback Interface (interface loopback)</b><br />A Loopback Interface is a virtual interface that is not associated with a
					physical network connection.  Protocols like Secure Shell (SSH) and Network
					Time Protocol can be bound to the loopback interface so they are not handled
					by interfaces associated with physical ports and actual networks.  <br />
					<span class="label label-success">Creation of a loopback interface is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="null" class="anchor"></a><b>Null Interface (interface null)</b><br />A Null Interface routes all traffic to a virtual location within the router
					where all packets are dropped.  Routing unwanted traffic to the null interface,
					also known as "null routing" or "black hole routing" is a very efficient method
					of getting rid of traffic that is unwanted or is most likely spoofed.  <br />
					<span class="label label-success">Creation of a Null Interface and routing spoofed traffic to it is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="aux" class="anchor"></a><b>Auxilliary Port (aux port)</b><br />The Auxilliary (aux) Port provides a means of physically connecting to the
					router via a serial cable.  Local administration of the router is usually done
					using the console port.  Disabling the aux port is recommended unless it is
					connected to a modem for out of band access.  If connected to a modem, both the
					modem and the aux port must be configured securely.  <br />
					<span class="label label-warning">Disabling the aux port is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="console" class="anchor"></a><b>Console Port</b><br />The Console Port is used to connect to the router locally.  A console cable
					is connected from the router's console port to a serial port on a computer.
					Once connected, the user brings up terminal emulation software like TeraTerm,
					Hyperterm, or Putty.  The console port permits sensitive operations like
					password revcovery, so it must be configured securely.  <br />
					<span class="label label-success">Secure configuration of the console port is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="vty" class="anchor"></a><b>Virtual Terminal (vty) Ports</b><br />Virtual Terminal (vty) Ports permit connection over the network.  Since they
					are accessible from anywhere using insecure protocols unless properly configured,
					they pose a great risk.  Access to them should be restricted to secure protocols
					such as Secure Shell (ssh) and only trusted IP addresses should be permitted.
					An Access Control List (acl) is used to restrict access to trusted IP addresses.  <br />
					<span class="label label-success">Secure configuration of the vty ports is recommended</span> </div></div>
					
					<h3><a id="#global_en">Global router commands (to be enabled)</a></h3><br />

					<div class="panel panel-default"><div class="panel-body"><a id="#cef" class="anchor"></a><b>ip cef</b><br />Cisco Express Forwarding (cef) in and of itself does not do much security wise.
					It can make the processing of through traffic faster.  Cef uses its own Forwarding
					Information Base (fib) to switch packets through the router.  This is faster than
					the default switching method, fast-switching.  <br />
					<span class="label label-success">Enabling cef is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="#ntp_receive" class="anchor"></a><b>ntp receive</b><br />Receiving time via Network Time Protocol (ntp) means that the log files generated
					by the router will have accurate timestamps.  Timestamp accuracy of log files is
					crucial to tracking attacks or attempted attacks.  The earlier commands disabling ntp
					on interfaces means the router will not serve as an ntp server.  A primary and backup
					ntp server should be configured for redundancy.  <br />
					<span class="label label-success">Enabling ntp reception is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="#pw_encryption" class="anchor"></a><b>password-encryption</b><br />Password encryption is better than leaving configured passwords clear text, but it
					is NOT secure.  Small, free programs such as Boson's GetPass can be used to decipher
					passwords encrypted in this way.  Even if you have password-encryption enabled,
					remember to protect your router configuration files.  <br />
					<span class="label label-success">Enabling service password-encryption is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="#tcp_keepalives_in" class="anchor"></a><b>tcp-keepalives-in</b><br />TCP Keepalives let the router calculate how long a TCP session has been connected
					and permit tracking of "idle time" or time that no user action has occured for a
					given connection.  <br />
					<span class="label label-success">Enabling tcp-keepalives in and out is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="#tcp_keepalives_out" class="anchor"></a><b>tcp-keepalives-out</b><br />TCP Keepalives let the router calculate how long a TCP session has been connected
					and permit tracking of "idle time" or time that no user action has occured for a
					given connection.  <br />
					<span class="label label-success">Enabling tcp-keepalives in and out is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="#ssh_time_out" class="anchor"></a><b>ssh timeout</b><br />If tcp-keepalives-in are enabled, idle SSH sessions can be logged of after a
					pre-set time.  The brst shuts down idle sessions after 20 minutes of inactivity.
					This reduces the chance that someone can walk up to a computer with a session
					connected and make changes.  <br />
					<span class="label label-success">Enabling ssh timeout is recommended</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="#ssh_auth_retries" class="anchor"></a><b>ssh authentication retries</b><br />SSH authentication retries (attempts where a bad username or password has been
					entered) can be limited to thwart brute force password cracking attempts.  The
					brst sets the number of attempts before lockout to three.  <br />
					<span class="label label-success">Limiting ssh authentication retries is recommended</span> </div></div>

					<h3>Access control</h3>

					<div class="panel panel-default"><div class="panel-body"><a id="#aux2" class="anchor"></a><b>aux port Configuration</b><br />The Auxilliary Port (aux port) presents an unneeded risk and should be disabled.
					If it us used for remote access, it should be secured. <br />
					<span class="label label-warning">Disabling the aux port is recommended.</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="#console2" class="anchor"></a><b>Console Port</b><br />The console port is often used for local administration.  It should be secured by requiring
					default login (aaa), and should have transport output none.<br />
					<span class="label label-success">Securing console port is recommended.</span> </div></div>

					<div class="panel panel-default"><div class="panel-body"><a id="#vty2" class="anchor"></a><b>vty ports</b><br />Virtual Terminal or vty ports are used for remote access and should be secured as tightly as
					practical.  Only a very limited number of IP Addresses should be allowed to access them, and only
					using secure protocols when possible.<br />
					<span class="label label-success">Securing vty ports is recommended.</span> </div></div>
            </div>
        </div>

	<footer>
		<div class="row">
			<div class="col-lg-12">	
				<div class="footer-font text-center">
					<h5>Disclaimer and Licensing</h5>
					<p>The "fine print."</p>
					<p>This software is not sponsored by, endorsed by or affiliated with Cisco Systems, Inc.  Cisco, Cisco Systems, and IOS are registered trademarks of Cisco Systems, Inc. in the USA and certain other countries.  All other trademarks are trademarks of their respective owners.</p>
					<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
					<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License for more details.</p>
					<p>A local copy of the license can be found at <a href="copying.html">copying</a>.</p>&nbsp;
				</div>
			</div>
		</div>
        <div class="row">
          <div class="col-lg-12">
            <ul class="list-unstyled">
              <li><a href="https://www.borderroutersec.org/">&copy; 2015 Ted LeRoy</a></li>
              <li class="pull-right"><a href="https://www.borderroutersec.org/">BorderRouterSec.org</a></li>
              <li class="pull-right"><a href="https://github.com/TedLeRoy/BRST">GitHub</a></li>
            </ul>
          </div>
        </div>
    </footer>

    </div><script src="js/jquery-1.10.2.min.js"></script> <script src="js/bootstrap.min.js"></script> <script src="js/bootswatch.js"></script>
</body>
</html>